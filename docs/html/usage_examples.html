<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Usage Examples - DFT Documentation</title>
    <link rel="stylesheet" href="../assets/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Usage Examples</h1>
            <p>Droplet-Film Theory Development Project</p>
            <nav>
                <a href="../index.html">Home</a>
                <a href="documentation.html">Documentation</a>
                <a href="installation_guide.html">Installation</a>
                <a href="usage_examples.html">Usage</a>
                <a href="api_reference.html">API Reference</a>
                <a href="troubleshooting.html">Troubleshooting</a>
            </nav>
        </header>
        
        <main>
            <div class="sidebar">
                <h3>Contents</h3>
                <ul>
                    <li><a href="#introduction">Introduction</a></li>
                    <li><a href="#installation">Installation</a></li>
                    <li><a href="#quick-start">Quick Start</a></li>
                    <li><a href="#data-format">Data Format</a></li>
                    <li><a href="#running">Running DFT Development</a></li>
                    <li><a href="#troubleshooting">Troubleshooting</a></li>
                    <li><a href="#examples">Examples</a></li>
                    <li><a href="#performance">Performance</a></li>
                    <li><a href="#how-to">How-to Guides</a></li>
                    <li><a href="#tutorials">Tutorial Scripts</a></li>
                </ul>
            </div>
            
            <div class="content">
<p class="paragraph">Usage Examples</p>
<p class="paragraph">Droplet-Film Theory Development</p>
<p class="paragraph">Scripts 2.0</p>
<p class="paragraph">Basic Usage Examples</p>
<p class="paragraph">This file contains practical code examples</p>
<div class="code-snippet">for using the DFT implementation.</div>
<p class="paragraph">Start with basic examples and progress to advanced usage.</p>
<p class="paragraph">Example 1: Basic Import and Setup</p>
<p class="paragraph"># Import required modules</p>
<div class="code-snippet">from dft_model import DFT</div>
<div class="code-snippet">from utils import ChiefBldr</div>
<div class="code-snippet">import pandas as pd</div>
<div class="code-snippet">import numpy as np</div>
<p class="paragraph">Example 1: Data Loading</p>
<p class="paragraph"># Load your dataset</p>
<p class="paragraph">data_path = "path/to/your/well_data.csv"</p>
<p class="paragraph">data = pd.read_csv(data_path)</p>
<p class="paragraph"># Verify required columns exist</p>
<p class="paragraph">required_cols = ['Dia', 'Dev(deg)', 'Area (m2)', 'z',</p>
<p class="paragraph">'GasDens', 'LiquidDens', 'g (m/s2)',</p>
<p class="paragraph">'P/T', 'friction_factor', 'critical_film_thickness']</p>
<p class="paragraph">Example 1: Initialize ChiefBldr</p>
<p class="paragraph"># Initialize the data builder</p>
<p class="paragraph">builder = ChiefBldr(</p>
<p class="paragraph">path=data_path,</p>
<p class="paragraph">includ_cols=required_cols,</p>
<p class="paragraph">test_size=0.20,</p>
<p class="paragraph">scale=False</p>
<p class="paragraph">)</p>
<p class="paragraph">Example 2: Basic DFT Model</p>
<p class="paragraph"># Create a simple DFT model</p>
<p class="paragraph">dft_model = DFT(</p>
<p class="paragraph">seed=42,</p>
<p class="paragraph">feature_tol=1.0,</p>
<p class="paragraph">dev_tol=1e-3,</p>
<p class="paragraph">multiple_dev_policy="max"</p>
<p class="paragraph">)</p>
<p class="paragraph">Example 2: Model Training</p>
<p class="paragraph"># Train the model with basic parameters</p>
<p class="paragraph">trained_model = builder.evolv_model(</p>
<p class="paragraph">build_model=lambda hparams: DFT(**hparams),</p>
<p class="paragraph">hparam_grid={"dev_tol": [1e-3], "feature_tol": [1.0]},</p>
<p class="paragraph">k_folds=5</p>
<p class="paragraph">)</p>
<p class="paragraph">Example 2: Make Predictions</p>
<p class="paragraph"># Make predictions on new data</p>
<p class="paragraph">X_new = np.array([[0.1, 15.0, 0.00785, 1000, 1.2, 1000, 9.81, 101325/298, 0.02, 0.001]])</p>
<p class="paragraph">predictions = trained_model.predict(X_new)</p>
<p class="paragraph">print(f"Predicted critical flow rate: {predictions[0]:.2f}")</p>
<p class="paragraph">Example 3: Hyperparameter Optimization</p>
<p class="paragraph"># Define hyperparameter grid</p>
<p class="paragraph">hparam_grid = {</p>
<p class="paragraph">"dev_tol": [1e-4, 1e-3, 1e-2],</p>
<p class="paragraph">"feature_tol": [0.5, 1.0, 2.0],</p>
<p class="paragraph">"multiple_dev_policy": ["max", "min", "mean"]</p>
<p class="paragraph">}</p>
<p class="paragraph">Example 3: Advanced Training</p>
<p class="paragraph"># Train with hyperparameter optimization</p>
<p class="paragraph">trained_model = builder.evolv_model(</p>
<p class="paragraph">build_model=lambda hparams: DFT(**hparams),</p>
<p class="paragraph">hparam_grid=hparam_grid,</p>
<p class="paragraph">k_folds=5</p>
<p class="paragraph">)</p>
<p class="paragraph">Example 3: Access Results</p>
<p class="paragraph"># Access training results</p>
<p class="paragraph">print(f"Training MSE: {builder.loss:.6f}")</p>
<p class="paragraph">print(f"Best parameters: {trained_model.opt_params[:5]}")</p>
<p class="paragraph"># Get alpha values</p>
<p class="paragraph">alpha_values = trained_model.opt_params[5:]</p>
<p class="paragraph">print(f"Alpha range: {alpha_values.min():.3f} to {alpha_values.max():.3f}")</p>
<p class="paragraph">Example 4: Performance Visualization</p>
<p class="paragraph"># Plot training performance</p>
<div class="code-snippet">import matplotlib.pyplot as plt</div>
<p class="paragraph">plt.figure(figsize=(12, 5))</p>
<p class="paragraph"># Training performance</p>
<p class="paragraph">plt.subplot(1, 2, 1)</p>
<p class="paragraph">plt.scatter(builder.y_train, builder.y_train_pred, alpha=0.7)</p>
<p class="paragraph">plt.plot([builder.y.min(), builder.y.max()], [builder.y.min(), builder.y.max()], 'r--')</p>
<p class="paragraph">plt.xlabel("Actual Values")</p>
<p class="paragraph">plt.ylabel("Predicted Values")</p>
<p class="paragraph">plt.title("Training Performance")</p>
<p class="paragraph">Example 4: Test Performance</p>
<p class="paragraph"># Test performance</p>
<p class="paragraph">plt.subplot(1, 2, 2)</p>
<p class="paragraph">plt.scatter(builder.y_test, builder.y_test_pred, alpha=0.7, color='green')</p>
<p class="paragraph">plt.plot([builder.y.min(), builder.y.max()], [builder.y.min(), builder.y.max()], 'r--')</p>
<p class="paragraph">plt.xlabel("Actual Values")</p>
<p class="paragraph">plt.ylabel("Predicted Values")</p>
<p class="paragraph">plt.title("Test Performance")</p>
<p class="paragraph">plt.tight_layout()</p>
<p class="paragraph">plt.show()</p>
<p class="paragraph">Example 5: QLattice Integration</p>
<p class="paragraph"># Use QLattice for symbolic regression</p>
<div class="code-snippet">from utils import QLatticeWrapper</div>
<p class="paragraph"># Initialize QLattice wrapper</p>
<p class="paragraph">ql_model = QLatticeWrapper(</p>
<p class="paragraph">feature_tags=builder.feature_names,</p>
<p class="paragraph">output_tag="Qcr",</p>
<p class="paragraph">max_complexity=8,</p>
<p class="paragraph">n_epochs=5</p>
<p class="paragraph">)</p>
<p class="paragraph">Example 5: QLattice Training</p>
<p class="paragraph"># Train QLattice model</p>
<p class="paragraph">ql_model.fit(builder.X_train, builder.y_train)</p>
<p class="paragraph"># Get symbolic expression</p>
<p class="paragraph">symbolic_expr = ql_model.express()</p>
<p class="paragraph">print(f"Symbolic expression: {symbolic_expr}")</p>
<p class="paragraph"># Make predictions</p>
<p class="paragraph">ql_predictions = ql_model.predict(builder.X_test)</p>
<p class="paragraph">Example 6: Model Persistence</p>
<p class="paragraph"># Save trained model for production use</p>
<div class="code-snippet">import pickle</div>
<p class="paragraph"># Save DFT model</p>
<div class="code-snippet">with open('trained_dft_model.pkl', 'wb') as f:</div>
<p class="paragraph">pickle.dump(trained_model, f)</p>
<p class="paragraph"># Save QLattice model</p>
<div class="code-snippet">with open('trained_qlattice_model.pkl', 'wb') as f:</div>
<p class="paragraph">pickle.dump(ql_model, f)</p>
<p class="paragraph">Example 6: Model Loading</p>
<p class="paragraph"># Load saved models</p>
<div class="code-snippet">with open('trained_dft_model.pkl', 'rb') as f:</div>
<p class="paragraph">loaded_dft = pickle.load(f)</p>
<div class="code-snippet">with open('trained_qlattice_model.pkl', 'rb') as f:</div>
<p class="paragraph">loaded_ql = pickle.load(f)</p>
<p class="paragraph"># Use loaded models</p>
<p class="paragraph">predictions_dft = loaded_dft.predict(X_new)</p>
<p class="paragraph">predictions_ql = loaded_ql.predict(X_new)</p>
<p class="paragraph">Example 7: Custom Alpha Strategy</p>
<p class="paragraph"># Implement custom alpha assignment</p>
<div class="code-snippet">def custom_alpha_strategy(X_new, X_train, alpha_train, dev_tol=1e-3):</div>
<p class="paragraph">alpha_used = []</p>
<p class="paragraph">dev_train = X_train[:, 1]  # Deviation angle column</p>
<div class="code-snippet">for i in range(len(X_new)):</div>
<p class="paragraph">d_new = X_new[i, 1]</p>
<p class="paragraph">match_idx = np.where(np.abs(dev_train - d_new) <= dev_tol)[0]</p>
<div class="code-snippet">if len(match_idx) == 0:</div>
<p class="paragraph">alpha_used.append(np.mean(alpha_train))</p>
<p class="paragraph">else:</p>
<p class="paragraph"># Use custom logic here</p>
<p class="paragraph">alpha_used.append(np.median(alpha_train[match_idx]))</p>
<p class="paragraph">return np.array(alpha_used)</p>
<p class="paragraph">Example 8: Batch Processing</p>
<p class="paragraph"># Process multiple datasets</p>
<p class="paragraph">datasets = ["well_data_1.csv", "well_data_2.csv", "well_data_3.csv"]</p>
<p class="paragraph">results = {}</p>
<div class="code-snippet">for dataset in datasets:</div>
<p class="paragraph">builder = ChiefBldr(path=dataset, test_size=0.2)</p>
<p class="paragraph">model = DFT(seed=42)</p>
<p class="paragraph">trained = builder.evolv_model(</p>
<p class="paragraph">build_model=lambda hparams: DFT(**hparams),</p>
<p class="paragraph">hparam_grid={"dev_tol": [1e-3]},</p>
<p class="paragraph">k_folds=3</p>
<p class="paragraph">)</p>
<p class="paragraph">results[dataset] = {"model": trained, "mse": builder.loss}</p>
<p class="paragraph">Example 9: Cross-Validation Analysis</p>
<p class="paragraph"># Perform detailed cross-validation analysis</p>
<div class="code-snippet">from sklearn.model_selection import KFold</div>
<p class="paragraph">kf = KFold(n_splits=5, shuffle=True, random_state=42)</p>
<p class="paragraph">cv_scores = []</p>
<div class="code-snippet">for train_idx, val_idx in kf.split(builder.X):</div>
<p class="paragraph">X_train_cv = builder.X[train_idx]</p>
<p class="paragraph">y_train_cv = builder.y[train_idx]</p>
<p class="paragraph">X_val_cv = builder.X[val_idx]</p>
<p class="paragraph">y_val_cv = builder.y[val_idx]</p>
<p class="paragraph">model_cv = DFT(seed=42)</p>
<p class="paragraph">model_cv.fit(X_train_cv, y_train_cv)</p>
<p class="paragraph">y_pred_cv = model_cv.predict(X_val_cv)</p>
<p class="paragraph">mse = np.mean((y_val_cv - y_pred_cv) ** 2)</p>
<p class="paragraph">cv_scores.append(mse)</p>
<p class="paragraph">Example 9: CV Results Analysis</p>
<p class="paragraph"># Analyze cross-validation results</p>
<p class="paragraph">print(f"CV MSE: {np.mean(cv_scores):.6f} Â± {np.std(cv_scores):.6f}")</p>
<p class="paragraph">print(f"CV scores: {cv_scores}")</p>
<p class="paragraph"># Plot CV results</p>
<p class="paragraph">plt.figure(figsize=(8, 6))</p>
<p class="paragraph">plt.plot(range(1, 6), cv_scores, 'bo-')</p>
<p class="paragraph">plt.xlabel("Fold")</p>
<p class="paragraph">plt.ylabel("MSE")</p>
<p class="paragraph">plt.title("Cross-Validation Performance")</p>
<p class="paragraph">plt.grid(True)</p>
<p class="paragraph">plt.show()</p>
<p class="paragraph">Example 10: Feature Importance Analysis</p>
<p class="paragraph"># Analyze feature importance by perturbation</p>
<div class="code-snippet">def feature_importance_analysis(model, X_sample, feature_names):</div>
<p class="paragraph">base_pred = model.predict(X_sample)</p>
<p class="paragraph">importance_scores = []</p>
<div class="code-snippet">for i in range(X_sample.shape[1]):</div>
<p class="paragraph">X_perturbed = X_sample.copy()</p>
<p class="paragraph">X_perturbed[:, i] *= 1.1  # 10% increase</p>
<p class="paragraph">pred_perturbed = model.predict(X_perturbed)</p>
<p class="paragraph">importance = np.mean(np.abs(pred_perturbed - base_pred))</p>
<p class="paragraph">importance_scores.append(importance)</p>
<p class="paragraph">return dict(zip(feature_names, importance_scores))</p>
<p class="paragraph">Example 10: Feature Importance Results</p>
<p class="paragraph"># Calculate and display feature importance</p>
<p class="paragraph">X_sample = builder.X_test[:10]  # Use first 10 test samples</p>
<p class="paragraph">importance = feature_importance_analysis(trained_model, X_sample, builder.feature_names)</p>
<p class="paragraph"># Sort by importance</p>
<p class="paragraph">sorted_importance = sorted(importance.items(), key=lambda x: x[1], reverse=True)</p>
<p class="paragraph">print("Feature Importance:")</p>
<div class="code-snippet">for feature, score in sorted_importance:</div>
<p class="paragraph">print(f"{feature}: {score:.6f}")</p>
<p class="paragraph">Example 11: Production Deployment</p>
<p class="paragraph"># Production-ready prediction function</p>
<div class="code-snippet">def predict_critical_flow_rate(well_data, model_path):</div>
<p class="paragraph">"""</p>
<p class="paragraph">Production function for critical flow rate prediction</p>
<p class="paragraph">Args:</p>
<p class="paragraph">well_data: Dictionary with well parameters</p>
<p class="paragraph">model_path: Path to saved model</p>
<p class="paragraph">Returns:</p>
<p class="paragraph">float: Predicted critical flow rate</p>
<p class="paragraph">"""</p>
<p class="paragraph"># Load model</p>
<div class="code-snippet">with open(model_path, 'rb') as f:</div>
<p class="paragraph">model = pickle.load(f)</p>
<p class="paragraph"># Prepare input data</p>
<p class="paragraph">X = np.array([[well_data['Dia'], well_data['Dev(deg)'],</p>
<p class="paragraph">well_data['Area (m2)'], well_data['z'],</p>
<p class="paragraph">well_data['GasDens'], well_data['LiquidDens'],</p>
<p class="paragraph">well_data['g (m/s2)'], well_data['P/T'],</p>
<p class="paragraph">well_data['friction_factor'], well_data['critical_film_thickness']]])</p>
<p class="paragraph"># Make prediction</p>
<p class="paragraph">prediction = model.predict(X)</p>
<p class="paragraph">return prediction[0]</p>
<p class="paragraph">Example 11: Production Usage</p>
<p class="paragraph"># Example production usage</p>
<p class="paragraph">well_params = {</p>
<p class="paragraph">'Dia': 0.1,</p>
<p class="paragraph">'Dev(deg)': 15.0,</p>
<p class="paragraph">'Area (m2)': 0.00785,</p>
<p class="paragraph">'z': 1000,</p>
<p class="paragraph">'GasDens': 1.2,</p>
<p class="paragraph">'LiquidDens': 1000,</p>
<p class="paragraph">'g (m/s2)': 9.81,</p>
<p class="paragraph">'P/T': 101325/298,</p>
<p class="paragraph">'friction_factor': 0.02,</p>
<p class="paragraph">'critical_film_thickness': 0.001</p>
<p class="paragraph">}</p>
<p class="paragraph">predicted_qcr = predict_critical_flow_rate(well_params, 'trained_dft_model.pkl')</p>
<p class="paragraph">print(f"Predicted Qcr: {predicted_qcr:.2f}")</p>
<p class="paragraph">Example 12: Error Handling</p>
<p class="paragraph"># Robust prediction function with error handling</p>
<div class="code-snippet">def robust_prediction(well_data, model_path):</div>
<div class="code-snippet">try:</div>
<p class="paragraph"># Validate input data</p>
<p class="paragraph">required_keys = ['Dia', 'Dev(deg)', 'Area (m2)', 'z', 'GasDens',</p>
<p class="paragraph">'LiquidDens', 'g (m/s2)', 'P/T', 'friction_factor',</p>
<p class="paragraph">'critical_film_thickness']</p>
<div class="code-snippet">for key in required_keys:</div>
<div class="code-snippet">if key not in well_data:</div>
<p class="paragraph">raise ValueError(f"Missing required parameter: {key}")</p>
<p class="paragraph"># Make prediction</p>
<p class="paragraph">result = predict_critical_flow_rate(well_data, model_path)</p>
<p class="paragraph">return {"success": True, "prediction": result, "error": None}</p>
<p class="paragraph">except Exception as e:</p>
<p class="paragraph">return {"success": False, "prediction": None, "error": str(e)}</p>
<p class="paragraph">Example 12: Error Handling Usage</p>
<p class="paragraph"># Test error handling</p>
<p class="paragraph"># Valid data</p>
<p class="paragraph">result_valid = robust_prediction(well_params, 'trained_dft_model.pkl')</p>
<p class="paragraph">print(f"Valid prediction: {result_valid}")</p>
<p class="paragraph"># Invalid data</p>
<p class="paragraph">invalid_params = {'Dia': 0.1}  # Missing parameters</p>
<p class="paragraph">result_invalid = robust_prediction(invalid_params, 'trained_dft_model.pkl')</p>
<p class="paragraph">print(f"Invalid prediction: {result_invalid}")</p>
<p class="paragraph">Complete Workflow Summary</p>
<h2 class="section">1. Data Preparation: Ensure CSV format with required columns</h2>
<h2 class="section">2. Environment Setup: Install dependencies and import modules</h2>
<h2 class="section">3. Data Loading: Use ChiefBldr for data preprocessing</h2>
<h2 class="section">4. Model Definition: Create DFT model with desired parameters</h2>
<h2 class="section">5. Training: Use evolv_model for hyperparameter optimization</h2>
<h2 class="section">6. Evaluation: Analyze performance metrics and visualize results</h2>
<h2 class="section">7. Deployment: Save model and create production functions</h2>
<p class="paragraph">Best Practices</p>
<li class="bullet-point">Always use virtual environments</li>
<li class="bullet-point">Validate input data before processing</li>
<li class="bullet-point">Implement proper error handling</li>
<li class="bullet-point">Document your workflows</li>
<li class="bullet-point">Test with sample data first</li>
<li class="bullet-point">Monitor model performance</li>
<li class="bullet-point">Keep models updated</li>
<li class="bullet-point">Use version control</li>
<p class="paragraph">Next Steps</p>
<h2 class="section">1. Review API_REFERENCE.srt for technical details</h2>
<h2 class="section">2. Check TROUBLESHOOTING.srt for common issues</h2>
<h2 class="section">3. Experiment with different parameters</h2>
<h2 class="section">4. Try different modeling approaches</h2>
<h2 class="section">5. Contribute to the project</h2>
<h2 class="section">6. Share your results</h2>
<p class="paragraph">End of Usage Examples</p>
<p class="paragraph">Return to MAIN_DOCUMENTATION.srt</p>
<div class="code-snippet">for overview and other documentation sections</div>
            </div>
        </main>
        
        <footer>
            <p>Generated on 2025-10-15 20:28:33</p>
            <p>Droplet-Film Theory Development Project</p>
        </footer>
    </div>
</body>
</html>