<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Reference - DFT Documentation</title>
    <link rel="stylesheet" href="../assets/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>API Reference</h1>
            <p>Droplet-Film Theory Development Project</p>
            <nav>
                <a href="../index.html">Home</a>
                <a href="documentation.html">Documentation</a>
                <a href="installation_guide.html">Installation</a>
                <a href="usage_examples.html">Usage</a>
                <a href="api_reference.html">API Reference</a>
                <a href="troubleshooting.html">Troubleshooting</a>
            </nav>
        </header>
        
        <main>
            <div class="sidebar">
                <h3>Contents</h3>
                <ul>
                    <li><a href="#introduction">Introduction</a></li>
                    <li><a href="#installation">Installation</a></li>
                    <li><a href="#quick-start">Quick Start</a></li>
                    <li><a href="#data-format">Data Format</a></li>
                    <li><a href="#running-dft-development">Running DFT Development</a></li>
                    <li><a href="#troubleshooting">Troubleshooting</a></li>
                    <li><a href="#examples">Examples</a></li>
                    <li><a href="#performance">Performance</a></li>
                    <li><a href="#how-to-guides">How-to Guides</a></li>
                    <li><a href="#tutorial-scripts">Tutorial Scripts</a></li>
                </ul>
            </div>
            
            <div class="content">
<h1 id="api-reference" class="main-header">API Reference</h1>
<ul class="flowing-list">
<li class="flowing-item">dft_model.py: Core physics model implementation</li>
<li class="flowing-item">utils.py: Data management and utility functions</li>
<li class="flowing-item">Individual Jupyter notebooks for different approaches</li>
</ul>
<p class="paragraph">Droplet-Film Theory Development Project Technical Documentation Overview This document provides comprehensive technical documentation for all classes, methods, and parameters in the DFT Development project. The API is designed to be both powerful and user-friendly, supporting both research and industrial applications. The project follows object-oriented design principles with clear separation of concerns between physics modeling, data management, and machine learning components. Core Classes and Modules The project consists of several key modules: DFT Class - Core Physics Model The DFT class implements the Droplet-Film Theory physics model for predicting critical flow rates in gas wells. Class Definition</p>
<div class="code-snippet">class DFT:</div>
<ul class="flowing-list">
<li class="flowing-item">seed (int): Random seed for reproducibility. Default: 42</li>
<li class="flowing-item">feature_tol (float): Feature distance threshold for matching. Default: 1.0</li>
<li class="flowing-item">dev_tol (float): Deviation tolerance for angle matching. Default: 1e-3</li>
<li class="flowing-item">multiple_dev_policy (str): Policy for handling multiple matches. Options: "max", "min", "mean", "median". Default: "max"</li>
</ul>
<ul class="flowing-list">
<li class="flowing-item">seed: Random seed value</li>
<li class="flowing-item">feature_tol: Feature tolerance threshold</li>
<li class="flowing-item">dev_tol: Deviation tolerance threshold</li>
<li class="flowing-item">multiple_dev_policy: Multiple match handling policy</li>
<li class="flowing-item">opt_params: Optimized parameters (set after fitting)</li>
<li class="flowing-item">n_train: Number of training samples (set after fitting)</li>
</ul>
<ul class="flowing-list">
<li class="flowing-item">X (np.ndarray): Input features array with shape (n_samples, 10)</li>
<li class="flowing-item">y (np.ndarray): Target values array with shape (n_samples,)</li>
</ul>
<ul class="flowing-list">
<li class="flowing-item">self: Fitted model instance</li>
</ul>
<p class="paragraph">""" Droplet-Film Theory model for predicting critical flow rates in gas wells. This class implements a physics-informed machine learning approach that combines fundamental fluid dynamics principles with data-driven optimization to predict when gas wells will experience liquid loading. """ Constructor __init__(self, seed=42, feature_tol=1.0, dev_tol=1e-3, multiple_dev_policy="max") Parameters: Attributes: Methods fit(self, X, y) Train the DFT model on provided data. Parameters: Returns: Features (in order):</p>
<h2 id="1-dia-well-diameter-meters" class="section">1. Dia: Well diameter (meters)</h2>
<h2 id="2-devdeg-well-deviation-angle-degrees" class="section">2. Dev(deg): Well deviation angle (degrees)</h2>
<h2 id="3-area-m2-cross-sectional-area-square-meters" class="section">3. Area (m2): Cross-sectional area (square meters)</h2>
<h2 id="4-z-elevation-change-meters" class="section">4. z: Elevation change (meters)</h2>
<h2 id="5-gasdens-gas-density-kgm³" class="section">5. GasDens: Gas density (kg/m³)</h2>
<h2 id="6-liquiddens-liquid-density-kgm³" class="section">6. LiquidDens: Liquid density (kg/m³)</h2>
<h2 id="7-g-ms2-gravitational-acceleration-ms²" class="section">7. g (m/s2): Gravitational acceleration (m/s²)</h2>
<h2 id="8-pt-pressuretemperature-ratio-pak" class="section">8. P/T: Pressure/Temperature ratio (Pa/K)</h2>
<h2 id="9-friction_factor-friction-factor-dimensionless" class="section">9. friction_factor: Friction factor (dimensionless)</h2>
<h2 id="10-critical_film_thickness-critical-film-thickness-meters" class="section">10. critical_film_thickness: Critical film thickness (meters)</h2>
<ul class="flowing-list">
<li class="flowing-item">Uses Powell optimization method from scipy.optimize</li>
<li class="flowing-item">Optimizes 5 global parameters (p1-p5) plus alpha values for each training sample</li>
<li class="flowing-item">Bounds: p1-p5 unbounded, alpha in [0, 1]</li>
<li class="flowing-item">Maximum iterations: 5000, maximum function calls: 10000</li>
</ul>
<ul class="flowing-list">
<li class="flowing-item">X (np.ndarray): New input data with shape (n_samples, 10)</li>
<li class="flowing-item">dev_train (np.ndarray, optional): Training deviation angles for alpha assignment</li>
<li class="flowing-item">alpha_strategy (str): Alpha assignment strategy. Must be 'enhanced_dev_based'</li>
</ul>
<ul class="flowing-list">
<li class="flowing-item">np.ndarray: Predicted values with shape (n_samples,)</li>
</ul>
<p class="paragraph">Implementation Details: predict(self, X, dev_train=None, alpha_strategy='enhanced_dev_based') Make predictions on new data. Parameters: Returns: Alpha Assignment Strategy: The method uses a sophisticated three-tier strategy based on well deviation angle:</p>
<h2 id="1-dev-10-regular-deviation-based-matching" class="section">1. Dev < 10°: Regular deviation-based matching</h2>
<ul class="flowing-list">
<li class="flowing-item">Find training samples within dev_tol</li>
<li class="flowing-item">Apply multiple_dev_policy if multiple matches found</li>
<li class="flowing-item">Use mean training alpha if no matches</li>
</ul>
<h2 id="2-10-dev-20-minimum-alpha-strategy" class="section">2. 10° ≤ Dev < 20°: Minimum alpha strategy</h2>
<ul class="flowing-list">
<li class="flowing-item">Find training samples within dev_tol</li>
<li class="flowing-item">Use minimum alpha among matches</li>
<li class="flowing-item">Use mean training alpha if no matches</li>
</ul>
<h2 id="3-dev-20-full-feature-matching" class="section">3. Dev ≥ 20°: Full-feature matching</h2>
<ul class="flowing-list">
<li class="flowing-item">Compute Euclidean distance to all training samples</li>
<li class="flowing-item">Use closest sample's alpha if distance < feature_tol</li>
<li class="flowing-item">Use mean training alpha otherwise</li>
</ul>
<ul class="flowing-list">
<li class="flowing-item">params (np.ndarray): Model parameters (5 global + alpha values)</li>
<li class="flowing-item">X (np.ndarray): Input features with shape (n_samples, 10)</li>
</ul>
<ul class="flowing-list">
<li class="flowing-item">np.ndarray: Predicted values with shape (n_samples,)</li>
</ul>
<ul class="flowing-list">
<li class="flowing-item">term1 = (2 × g × Dia × (1 - 3×(Dia/h_cr) + 3×(Dia/h_cr)²) × (ρ_l - ρ_g) × cos(Dev) / (f × ρ_g)) × p4</li>
<li class="flowing-item">term2 = |sin(p5 × Dev)|^p3 × ((ρ_l - ρ_g)^p2 / ρ_g²)</li>
</ul>
<ul class="flowing-list">
<li class="flowing-item">params (np.ndarray): Model parameters</li>
</ul>
<ul class="flowing-list">
<li class="flowing-item">float: Mean squared error loss</li>
</ul>
<p class="paragraph">_eq(self, params, X) Compute predicted values using the physics equation. Parameters: Returns: Physics Equation: Qcr = p1 × √(|term1 × α + (1-α) × term2| × (1/z) × (P/T)) Where: _loss(self, params) Compute loss function for optimization. Parameters: Returns: ChiefBldr Class - Data Management The ChiefBldr class handles dataset loading, preprocessing, model training, and evaluation. Class Definition</p>
<div class="code-snippet">class ChiefBldr:</div>
<ul class="flowing-list">
<li class="flowing-item">path (str): Path to dataset file (CSV format)</li>
<li class="flowing-item">seed (int): Random seed for reproducibility. Default: 42</li>
<li class="flowing-item">drop_cols (List[str], optional): Columns to exclude from analysis</li>
<li class="flowing-item">includ_cols (List[str], optional): Columns to include in analysis</li>
<li class="flowing-item">test_size (float): Fraction of data for test set. Default: 0.20</li>
<li class="flowing-item">scale (bool): Whether to scale features. Default: False</li>
</ul>
<ul class="flowing-list">
<li class="flowing-item">X (np.ndarray): Full feature matrix with shape (n_samples, n_features)</li>
<li class="flowing-item">y (np.ndarray): Target values with shape (n_samples,)</li>
<li class="flowing-item">X_train (np.ndarray): Training features</li>
<li class="flowing-item">X_test (np.ndarray): Test features</li>
<li class="flowing-item">y_train (np.ndarray): Training targets</li>
<li class="flowing-item">y_test (np.ndarray): Test targets</li>
<li class="flowing-item">feature_names (List[str]): List of feature column names</li>
<li class="flowing-item">scaler (StandardScaler): Fitted scaler (if scale=True)</li>
</ul>
<ul class="flowing-list">
<li class="flowing-item">build_model (Callable): Function that creates model from hyperparameters</li>
<li class="flowing-item">hparam_grid (Dict): Dictionary of hyperparameter lists to try</li>
<li class="flowing-item">k_folds (int): Number of cross-validation folds. Default: 5</li>
</ul>
<ul class="flowing-list">
<li class="flowing-item">Any: Best trained model</li>
</ul>
<ul class="flowing-list">
<li class="flowing-item">Performs grid search over all hyperparameter combinations</li>
<li class="flowing-item">Uses k-fold cross-validation for each combination</li>
<li class="flowing-item">Selects best model based on validation performance</li>
<li class="flowing-item">Stores training and test predictions</li>
<li class="flowing-item">Computes performance metrics (MSE, R²)</li>
</ul>
<ul class="flowing-list">
<li class="flowing-item">loss (float): Mean squared error on training data</li>
<li class="flowing-item">r2_score (float): R-squared correlation coefficient</li>
<li class="flowing-item">y_train_pred (np.ndarray): Training predictions</li>
<li class="flowing-item">y_test_pred (np.ndarray): Test predictions</li>
</ul>
<p class="paragraph">""" Data management and model training utility class. This class provides comprehensive functionality for loading datasets, splitting data, training models, and evaluating performance. """ Constructor __init__(self, path, seed=42, drop_cols=None, includ_cols=None, test_size=0.20, scale=False) Parameters: Attributes (set after initialization): Methods evolv_model(self, build_model, hparam_grid, k_folds=5) Train model with hyperparameter optimization. Parameters: Returns: Implementation Details: Performance Metrics (set after training): QLatticeWrapper Class - Symbolic Regression The QLatticeWrapper class provides interface to Feyn QLattice for automated symbolic regression. Class Definition</p>
<div class="code-snippet">class QLatticeWrapper:</div>
<ul class="flowing-list">
<li class="flowing-item">feature_tags (List[str]): List of feature names</li>
<li class="flowing-item">output_tag (str): Target variable name. Default: "Qcr"</li>
<li class="flowing-item">seed (int): Random seed for reproducibility. Default: 42</li>
<li class="flowing-item">max_complexity (int): Maximum model complexity. Default: 10</li>
<li class="flowing-item">n_epochs (int): Number of training epochs. Default: 10</li>
<li class="flowing-item">criterion (str): Model selection criterion. Options: "bic", "aic", "r2". Default: "bic"</li>
</ul>
<ul class="flowing-list">
<li class="flowing-item">seed: Random seed value</li>
<li class="flowing-item">feature_tags: List of feature names</li>
<li class="flowing-item">output_tag: Target variable name</li>
<li class="flowing-item">max_complexity: Maximum model complexity</li>
<li class="flowing-item">n_epochs: Number of training epochs</li>
<li class="flowing-item">criterion: Model selection criterion</li>
<li class="flowing-item">ql: QLattice connection object</li>
<li class="flowing-item">opt_model: Optimized model (set after fitting)</li>
<li class="flowing-item">y_pred: Predictions (set after fitting)</li>
</ul>
<ul class="flowing-list">
<li class="flowing-item">X (np.ndarray): Input features with shape (n_samples, n_features)</li>
<li class="flowing-item">y (np.ndarray): Target values with shape (n_samples,)</li>
</ul>
<ul class="flowing-list">
<li class="flowing-item">self: Fitted model instance</li>
</ul>
<ul class="flowing-list">
<li class="flowing-item">Converts NumPy arrays to pandas DataFrames</li>
<li class="flowing-item">Connects to QLattice service</li>
<li class="flowing-item">Trains model with specified parameters</li>
<li class="flowing-item">Selects best model based on criterion</li>
</ul>
<ul class="flowing-list">
<li class="flowing-item">X (np.ndarray): Input features with shape (n_samples, n_features)</li>
</ul>
<ul class="flowing-list">
<li class="flowing-item">np.ndarray: Predicted values with shape (n_samples,)</li>
</ul>
<ul class="flowing-list">
<li class="flowing-item">sympy.Expr: Symbolic expression in SymPy format</li>
</ul>
<p class="paragraph">""" Wrapper class for Feyn QLattice symbolic regression. This class provides a scikit-learn compatible interface to QLattice, enabling automated discovery of mathematical expressions from data. """ Constructor __init__(self, feature_tags, output_tag="Qcr", seed=42, max_complexity=10, n_epochs=10, criterion="bic") Parameters: Attributes: Methods fit(self, X, y) Train the QLattice model. Parameters: Returns: Implementation Details: predict(self, X) Make predictions on new data. Parameters: Returns: express(self) Get symbolic expression of the trained model. Returns: Data Format Requirements Input CSV files must contain exactly these columns:</p>
<h2 id="1-dia-float-well-diameter-in-meters" class="section">1. Dia (float): Well diameter in meters</h2>
<h2 id="2-devdeg-float-well-deviation-angle-in-degrees" class="section">2. Dev(deg) (float): Well deviation angle in degrees</h2>
<h2 id="3-area-m2-float-cross-sectional-area-in-square-meters" class="section">3. Area (m2) (float): Cross-sectional area in square meters</h2>
<h2 id="4-z-float-elevation-change-in-meters" class="section">4. z (float): Elevation change in meters</h2>
<h2 id="5-gasdens-float-gas-density-in-kgm³" class="section">5. GasDens (float): Gas density in kg/m³</h2>
<h2 id="6-liquiddens-float-liquid-density-in-kgm³" class="section">6. LiquidDens (float): Liquid density in kg/m³</h2>
<h2 id="7-g-ms2-float-gravitational-acceleration-in-ms²" class="section">7. g (m/s2) (float): Gravitational acceleration in m/s²</h2>
<h2 id="8-pt-float-pressuretemperature-ratio-in-pak" class="section">8. P/T (float): Pressure/Temperature ratio in Pa/K</h2>
<h2 id="9-friction_factor-float-friction-factor-dimensionless" class="section">9. friction_factor (float): Friction factor (dimensionless)</h2>
<h2 id="10-critical_film_thickness-float-critical-film-thickness-in-meters" class="section">10. critical_film_thickness (float): Critical film thickness in meters</h2>
<ul class="flowing-list">
<li class="flowing-item">Missing value detection and handling</li>
<li class="flowing-item">Data type validation</li>
<li class="flowing-item">Column name verification</li>
<li class="flowing-item">Range checking for physical parameters</li>
</ul>
<ul class="flowing-list">
<li class="flowing-item">Invalid input data formats</li>
<li class="flowing-item">Missing required columns</li>
<li class="flowing-item">Optimization convergence failures</li>
<li class="flowing-item">Memory allocation issues</li>
<li class="flowing-item">Network connectivity problems (QLattice)</li>
</ul>
<ul class="flowing-list">
<li class="flowing-item">Scales linearly with dataset size</li>
<li class="flowing-item">DFT model: O(n_samples × n_features)</li>
<li class="flowing-item">ChiefBldr: O(n_samples × n_features)</li>
<li class="flowing-item">QLattice: O(n_samples × n_features × complexity)</li>
</ul>
<ul class="flowing-list">
<li class="flowing-item">DFT model: O(n_samples × n_iterations)</li>
<li class="flowing-item">ChiefBldr: O(n_combinations × k_folds × n_samples)</li>
<li class="flowing-item">QLattice: O(n_epochs × complexity × n_samples)</li>
</ul>
<ul class="flowing-list">
<li class="flowing-item">Use data sampling for large datasets during development</li>
<li class="flowing-item">Consider parallel processing for hyperparameter optimization</li>
<li class="flowing-item">Monitor memory usage with large feature spaces</li>
</ul>
<ul class="flowing-list">
<li class="flowing-item">Scikit-learn: Compatible fit/predict interface</li>
<li class="flowing-item">Pandas: DataFrame input/output support</li>
<li class="flowing-item">NumPy: Array-based operations</li>
<li class="flowing-item">Matplotlib/Seaborn: Visualization integration</li>
<li class="flowing-item">Jupyter: Interactive development support</li>
</ul>
<p class="paragraph">Data Validation The ChiefBldr class automatically validates data format and handles common issues: Error Handling The API includes comprehensive error handling for: Performance Considerations Memory Usage: Training Time: Scalability: Integration Capabilities The API is designed for seamless integration with: Type Hints All functions include comprehensive type hints for better IDE support and code documentation:</p>
<pre><code>
<span class="code-line">from typing import Optional, List, Callable, Dict, Any, Union</span>
<span class="code-line">import numpy as np</span>
<span class="code-line">import pandas as pd</span>
</code></pre>
<ul class="flowing-list">
<li class="flowing-item">Comprehensive docstrings for all functions</li>
<li class="flowing-item">Type hints for better code clarity</li>
<li class="flowing-item">Unit test framework support</li>
<li class="flowing-item">Error message localization</li>
<li class="flowing-item">Logging capabilities for debugging</li>
</ul>
<ul class="flowing-list">
<li class="flowing-item">Additional physics models (drift-flux, mechanistic)</li>
<li class="flowing-item">Ensemble methods for improved accuracy</li>
<li class="flowing-item">Real-time prediction capabilities</li>
<li class="flowing-item">REST API endpoints for web integration</li>
<li class="flowing-item">Cloud deployment support</li>
<li class="flowing-item">GPU acceleration for large datasets</li>
</ul>
<p class="paragraph">Development and Testing The codebase includes: Future API Extensions Planned additions include: Migration Guide For users upgrading from previous versions:</p>
<h2 id="1-update-import-statements-if-module-structure-changed" class="section">1. Update import statements if module structure changed</h2>
<h2 id="2-check-parameter-names-for-any-modifications" class="section">2. Check parameter names for any modifications</h2>
<h2 id="3-verify-data-format-compatibility" class="section">3. Verify data format compatibility</h2>
<h2 id="4-test-with-sample-data-before-full-deployment" class="section">4. Test with sample data before full deployment</h2>
<h2 id="5-review-performance-metrics-for-any-changes" class="section">5. Review performance metrics for any changes</h2>
<ul class="flowing-list">
<li class="flowing-item">No deprecated features in current version</li>
<li class="flowing-item">Future deprecations will be announced with 6-month notice</li>
<li class="flowing-item">Migration guides will be provided for all breaking changes</li>
</ul>
<ul class="flowing-list">
<li class="flowing-item">GitHub repository: Primary source for code and issues</li>
<li class="flowing-item">Documentation: Comprehensive guides and examples</li>
<li class="flowing-item">Community forums: User discussions and support</li>
<li class="flowing-item">Issue tracker: Bug reports and feature requests</li>
<li class="flowing-item">Research papers: Scientific background and validation</li>
</ul>
<p class="paragraph">Deprecation Notices Support and Resources This API reference provides complete technical documentation for the DFT Development project. For additional examples and tutorials, refer to the Usage Examples guide and individual Jupyter notebooks.</p>
            </div>
        </main>
        
        <footer>
            <p>Generated on 2025-10-15 21:33:01</p>
            <p>Droplet-Film Theory Development Project</p>
        </footer>
    </div>
</body>
</html>